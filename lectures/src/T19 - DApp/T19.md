---
marp: true
theme: default
class: default
author: Nirand Pisutha-Arnond
paginate: true
footer: "255499: Blockchain for Industrial Engineers"
---

<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,300;0,400;0,700;1,100;1,300;1,400;1,700&display=swap');

    :root {
    font-family: Prompt;
    --hl-color: #D57E7E;
}
h1 {
  font-family: Prompt
}
</style>

# Blockchain for Industrial Engineers: Decentralized Application Development

## บล็อกเชนสำหรับวิศวกรอุตสาหการ: การพัฒนาแอปพลิเคชันแบบกระจายศูนย์

---

# Decentralized application (DApp)

---

# Part 1

---

# Template

- Fork the following repository
  - https://github.com/nnnpooh/blockchain-class-dapp
- Clone your new forked repository to local machine
  - `git clone ......`
- Open the newly cloned folder in `VSCode`
- Install library
  - `npm install`
- Run
  - `npm run dev`

---

# Structure

- `Home` component
  - `NavBar` component
  - `Body` component
- Reactive variable
  - `secret`
    ![bg right:50%](./img/p1_1.jpg)

---

# Part 2

---

# Library

- Install `ethers` library
  - `npm install ethers@5.7.2`

---

# `_app` file

- Manage layout
  ![bg contain right:50%](./img/p2_1.jpg)

---

# Centralized store

---

# Stores

- `useWorkingStore()`
  - `secret`
- `useMetaMaskStore()`
  - `account`
  - `balance`
  - `chainId`
  - `isEthereumAvailable`
  - `provider`
- [`./src/utils/stores.ts`](https://gist.github.com/nnnpooh/8a8ed7ebe3659c73d159e1e495d7af86#file-stores-ts)

---

# Startup Logics

- Open MetaMask
- Setup listener
  - Change account
  - Change network
- [`./src/utils/useEthereum.ts`](https://gist.github.com/nnnpooh/8a8ed7ebe3659c73d159e1e495d7af86#file-useethereum-ts)
  - Using `useEffect` function
- Insert `useEthereum()` into `_app.tsx`

---

# Fix `TypeScript` Error

- `types/index.d.ts`

```js
import { ExternalProvider } from "@ethersproject/providers";
import { MetaMaskInpageProvider } from "@metamask/providers";

declare global {
  interface Window {
    ethereum?: MetaMaskInpageProvider;
  }
}

export {};
```

---

- `tsconfig.json`

```json
...
"typeRoots": ["./node_modules/@types", "./src/types"],
...
```

---

# React to change in state

- When you change account and network in Metamask, the application should react to it.
  - `useEffect` with dependency.
- [./src/utils/useMetaMask.ts](https://gist.github.com/nnnpooh/8a8ed7ebe3659c73d159e1e495d7af86#file-usemetamask-ts)
- Insert `useEthereum()` into `_app.tsx`
- Insert `useMetaMask()` into into `_app.tsx`

---

# Update `AccountButton`

- [AccountButton](https://gist.github.com/nnnpooh/8a8ed7ebe3659c73d159e1e495d7af86#file-navbar-tsx)
